diff --git a/src/main/java/com/company/usermanagement/UsermanagementApplication.java b/src/main/java/com/company/usermanagement/UsermanagementApplication.java
index c9fb703..c99421e 100644
--- a/src/main/java/com/company/usermanagement/UsermanagementApplication.java
+++ b/src/main/java/com/company/usermanagement/UsermanagementApplication.java
@@ -9,10 +9,9 @@ import org.springframework.context.annotation.PropertySource;
 @SpringBootApplication
 @EnableConfigurationProperties(JwtProperties.class)
 @PropertySource("classpath:.env")
-public class UsermanagementApplication {
-
-	public static void main(String[] args) {
-		SpringApplication.run(UsermanagementApplication.class, args);
-	}
-
-}
+public class UsermanagementApplication {
+
+	public static void main(String[] args) {
+		SpringApplication.run(UsermanagementApplication.class, args);
+	}
+}
diff --git a/src/main/java/com/company/usermanagement/configuration/security/JwtConfig.java b/src/main/java/com/company/usermanagement/configuration/security/JwtConfig.java
index cca4a23..9ecdb65 100644
--- a/src/main/java/com/company/usermanagement/configuration/security/JwtConfig.java
+++ b/src/main/java/com/company/usermanagement/configuration/security/JwtConfig.java
@@ -1,21 +1,24 @@
 package com.company.usermanagement.configuration.security;
 
+import java.util.Base64;
+import javax.crypto.SecretKey;
+
 import io.jsonwebtoken.security.Keys;
-import org.springframework.beans.factory.annotation.Value;
 import org.springframework.context.annotation.Bean;
 import org.springframework.context.annotation.Configuration;
-import javax.crypto.SecretKey;
-import java.util.Base64;
 
 @Configuration
 public class JwtConfig {
 
-    @Value("${security.secret}")
-    private String secret;
+    private final JwtProperties jwtProperties;
+
+    public JwtConfig(JwtProperties jwtProperties) {
+        this.jwtProperties = jwtProperties;
+    }
 
     @Bean
     public SecretKey secretKey() {
-        byte[] keyBytes = Base64.getDecoder().decode(secret);
+        byte[] keyBytes = Base64.getDecoder().decode(jwtProperties.secret());
         return Keys.hmacShaKeyFor(keyBytes);
     }
-}
\ No newline at end of file
+}
diff --git a/src/main/java/com/company/usermanagement/configuration/security/JwtProperties.java b/src/main/java/com/company/usermanagement/configuration/security/JwtProperties.java
index 95267c9..45fb1bc 100644
--- a/src/main/java/com/company/usermanagement/configuration/security/JwtProperties.java
+++ b/src/main/java/com/company/usermanagement/configuration/security/JwtProperties.java
@@ -4,4 +4,4 @@ import org.springframework.boot.context.properties.ConfigurationProperties;
 
 @ConfigurationProperties(prefix = "security")
 public record JwtProperties(String secret, String param, String prefix) {
-}
\ No newline at end of file
+}
diff --git a/src/main/java/com/company/usermanagement/configuration/security/SecurityConfig.java b/src/main/java/com/company/usermanagement/configuration/security/SecurityConfig.java
index a78b2d6..fc63d2a 100644
--- a/src/main/java/com/company/usermanagement/configuration/security/SecurityConfig.java
+++ b/src/main/java/com/company/usermanagement/configuration/security/SecurityConfig.java
@@ -40,7 +40,7 @@ public class SecurityConfig {
     @Bean
     public PasswordEncoder passwordEncoder() {
         String idForEncode = "bcrypt";
-        Map encoders = new HashMap<>();
+        Map<String, PasswordEncoder> encoders = new HashMap<>();
         encoders.put(idForEncode, new BCryptPasswordEncoder());
         encoders.put("noop", NoOpPasswordEncoder.getInstance());
         encoders.put("pbkdf2@SpringSecurity_v5_8", Pbkdf2PasswordEncoder.defaultsForSpringSecurity_v5_8());
@@ -126,4 +126,3 @@ public class SecurityConfig {
 
 }
 
-
diff --git a/src/main/java/com/company/usermanagement/controller/AuthController.java b/src/main/java/com/company/usermanagement/controller/AuthController.java
index f8957eb..a430a6c 100644
--- a/src/main/java/com/company/usermanagement/controller/AuthController.java
+++ b/src/main/java/com/company/usermanagement/controller/AuthController.java
@@ -20,11 +20,11 @@ import org.springframework.web.bind.annotation.RestController;
 @RestController
 @RequestMapping("/api/auth")
 @Tag(name = "Authentication", description = "Endpoint per Login e Logout")
-public class AuthController {
-
-    private final AuthenticationManager authenticationManager;
-    private final UserService userService;
-    private final JwtService jwtService;
+public class AuthController {
+
+    private final AuthenticationManager authenticationManager;
+    private final UserService userService;
+    private final JwtService jwtService;
 
     public AuthController(AuthenticationManager authenticationManager, UserService userService, JwtService jwtService) {
         this.authenticationManager = authenticationManager;
@@ -33,30 +33,23 @@ public class AuthController {
     }
 
     @PostMapping("/login")
-    public ResponseEntity<LoginResponseDTO> login(@RequestBody LoginRequestDTO requestDTO) {
-        Authentication authentication = authenticationManager.authenticate(
-                new UsernamePasswordAuthenticationToken(
-                        requestDTO.username(), requestDTO.password())
-        );
-
-        SecurityContextHolder.getContext().setAuthentication(authentication);
-        String token = jwtService.generateToken(authentication);
-
-
-        User user = userService.loadUserByUsername(requestDTO.username());
-
-
-        LoginResponseDTO response = new LoginResponseDTO(token, user.getName());
-
-        // Restituisci il DTO, Spring lo convertirà in JSON automaticamente
-        return ResponseEntity.ok(response);
-    }
+    public ResponseEntity<LoginResponseDTO> login(@RequestBody LoginRequestDTO requestDTO) {
+        Authentication authentication = authenticationManager.authenticate(
+                new UsernamePasswordAuthenticationToken(
+                        requestDTO.username(), requestDTO.password())
+        );
+
+        SecurityContextHolder.getContext().setAuthentication(authentication);
+        String token = jwtService.generateToken(authentication);
+        User user = userService.loadUserByUsername(requestDTO.username());
+        LoginResponseDTO response = new LoginResponseDTO(token, user.getName());
+
+        return ResponseEntity.ok(response);
+    }
 
     @PostMapping("/register")
     public ResponseEntity<String> register(@RequestBody RegisterRequestDTO requestDTO) {
-        userService.registerUser(requestDTO);
-        return ResponseEntity.ok("Registrazione OK");
-    }
-
-
-}
+        userService.registerUser(requestDTO);
+        return ResponseEntity.ok("Registrazione OK");
+    }
+}
diff --git a/src/main/java/com/company/usermanagement/entity/Role.java b/src/main/java/com/company/usermanagement/entity/Role.java
index c2c734f..a6fc21a 100644
--- a/src/main/java/com/company/usermanagement/entity/Role.java
+++ b/src/main/java/com/company/usermanagement/entity/Role.java
@@ -1,7 +1,7 @@
 package com.company.usermanagement.entity;
 
-public enum Role {
-    USER,
-    ADMIN,
-    MODERATOR
-}
+public enum Role {
+    USER,
+    ADMIN,
+    MODERATOR
+}
diff --git a/src/main/java/com/company/usermanagement/entity/User.java b/src/main/java/com/company/usermanagement/entity/User.java
index ef24497..3b1b79f 100644
--- a/src/main/java/com/company/usermanagement/entity/User.java
+++ b/src/main/java/com/company/usermanagement/entity/User.java
@@ -45,14 +45,12 @@ public class User implements UserDetails {
     @ElementCollection(targetClass = Role.class, fetch = FetchType.EAGER)
     @CollectionTable(name = "user_roles", joinColumns = @JoinColumn(name = "user_id"))
     @Enumerated(EnumType.STRING)
-    @Column(name = "role")
-    private Set<Role> roles;
-
-    //
-
-    @Override
-    public Collection<? extends GrantedAuthority> getAuthorities() {
-        return roles.stream()
+    @Column(name = "role")
+    private Set<Role> roles;
+
+    @Override
+    public Collection<? extends GrantedAuthority> getAuthorities() {
+        return roles.stream()
                 .map(role -> new SimpleGrantedAuthority("ROLE_" + role.name()))
                 .collect(Collectors.toList());
     }
diff --git a/src/main/java/com/company/usermanagement/entity/dtoIN/LoginRequestDTO.java b/src/main/java/com/company/usermanagement/entity/dtoIN/LoginRequestDTO.java
index 8ce71d8..d1d9015 100644
--- a/src/main/java/com/company/usermanagement/entity/dtoIN/LoginRequestDTO.java
+++ b/src/main/java/com/company/usermanagement/entity/dtoIN/LoginRequestDTO.java
@@ -3,12 +3,11 @@ package com.company.usermanagement.entity.dtoIN;
 import jakarta.validation.constraints.NotBlank;
 import jakarta.validation.constraints.Size;
 
-public record LoginRequestDTO(
-
-        @NotBlank(message = "Lo username non può essere vuoto")
-        String username,
+public record LoginRequestDTO(
+        @NotBlank(message = "Lo username non può essere vuoto")
+        String username,
 
         @NotBlank(message = "La password non può essere vuota")
-        @Size(min = 8, message = "La password deve essere di almeno 8 caratteri")
-        String password
-) {}
+        @Size(min = 8, message = "La password deve essere di almeno 8 caratteri")
+        String password
+) {}
diff --git a/src/main/java/com/company/usermanagement/entity/dtoIN/RegisterRequestDTO.java b/src/main/java/com/company/usermanagement/entity/dtoIN/RegisterRequestDTO.java
index 30a6271..805b3ea 100644
--- a/src/main/java/com/company/usermanagement/entity/dtoIN/RegisterRequestDTO.java
+++ b/src/main/java/com/company/usermanagement/entity/dtoIN/RegisterRequestDTO.java
@@ -3,9 +3,9 @@ package com.company.usermanagement.entity.dtoIN;
 import jakarta.validation.constraints.NotBlank;
 import jakarta.validation.constraints.Size;
 
-public record RegisterRequestDTO (
-        @NotBlank(message = "Lo username non può essere vuoto")
-        String username,
+public record RegisterRequestDTO (
+        @NotBlank(message = "Lo username non può essere vuoto")
+        String username,
 
         @NotBlank(message = "La password non può essere vuota")
         @Size(min = 8, message = "La password deve essere di almeno 8 caratteri")
@@ -14,6 +14,6 @@ public record RegisterRequestDTO (
         @NotBlank(message = "La email non può essere vuota")
         String email,
 
-        @NotBlank(message = "Il nome non può essere vuoto")
-        String name
-) {}
+        @NotBlank(message = "Il nome non può essere vuoto")
+        String name
+) {}
diff --git a/src/main/java/com/company/usermanagement/entity/dtoOut/LoginResponseDTO.java b/src/main/java/com/company/usermanagement/entity/dtoOut/LoginResponseDTO.java
index d561bd4..b7eca64 100644
--- a/src/main/java/com/company/usermanagement/entity/dtoOut/LoginResponseDTO.java
+++ b/src/main/java/com/company/usermanagement/entity/dtoOut/LoginResponseDTO.java
@@ -1,4 +1,4 @@
 package com.company.usermanagement.entity.dtoOut;
 
-public record LoginResponseDTO (String token, String name)
-{}
+public record LoginResponseDTO(String token, String name) {
+}
diff --git a/src/main/java/com/company/usermanagement/entity/dtoOut/RegisterResponseDTO.java b/src/main/java/com/company/usermanagement/entity/dtoOut/RegisterResponseDTO.java
index 8baba41..b323de5 100644
--- a/src/main/java/com/company/usermanagement/entity/dtoOut/RegisterResponseDTO.java
+++ b/src/main/java/com/company/usermanagement/entity/dtoOut/RegisterResponseDTO.java
@@ -1,4 +1,4 @@
 package com.company.usermanagement.entity.dtoOut;
 
-public record RegisterResponseDTO (String username, String nome)
-{}
+public record RegisterResponseDTO(String username, String nome) {
+}
diff --git a/src/main/java/com/company/usermanagement/exception/ApiErrorResponse.java b/src/main/java/com/company/usermanagement/exception/ApiErrorResponse.java
index 567185e..4093f0e 100644
--- a/src/main/java/com/company/usermanagement/exception/ApiErrorResponse.java
+++ b/src/main/java/com/company/usermanagement/exception/ApiErrorResponse.java
@@ -1,6 +1,6 @@
 package com.company.usermanagement.exception;
 
-import lombok.*;
+import lombok.Builder;
 
 import java.time.LocalDateTime;
 
@@ -12,4 +12,3 @@ public record ApiErrorResponse(int status, String error, String message, LocalDa
     }
 
 }
-
diff --git a/src/main/java/com/company/usermanagement/exception/GlobalExceptionHandler.java b/src/main/java/com/company/usermanagement/exception/GlobalExceptionHandler.java
index cdd2b97..6cc2063 100644
--- a/src/main/java/com/company/usermanagement/exception/GlobalExceptionHandler.java
+++ b/src/main/java/com/company/usermanagement/exception/GlobalExceptionHandler.java
@@ -9,13 +9,18 @@ import org.springframework.web.bind.annotation.RestControllerAdvice;
 @RestControllerAdvice
 public class GlobalExceptionHandler {
 
+    private static final String USER_ALREADY_EXISTS = "USER_ALREADY_EXISTS";
+    private static final String USER_NOT_FOUND = "USER_NOT_FOUND";
+    private static final String REGISTRATION_ERROR = "REGISTRATION_ERROR";
+    private static final String INTERNAL_ERROR = "INTERNAL_ERROR";
+
     @ExceptionHandler(UserAlreadyExistsException.class)
     public ResponseEntity<ApiErrorResponse> handleUserAlreadyExists(UserAlreadyExistsException ex) {
         return ResponseEntity
                 .status(HttpStatus.CONFLICT)
                 .body(new ApiErrorResponse(
                         HttpStatus.CONFLICT.value(),
-                        "USER_ALREADY_EXISTS",
+                        USER_ALREADY_EXISTS,
                         ex.getMessage()
                 ));
     }
@@ -26,7 +31,7 @@ public class GlobalExceptionHandler {
                 .status(HttpStatus.NOT_FOUND)
                 .body(new ApiErrorResponse(
                         HttpStatus.NOT_FOUND.value(),
-                        "USER_NOT_FOUND",
+                        USER_NOT_FOUND,
                         ex.getMessage()
                 ));
     }
@@ -37,7 +42,7 @@ public class GlobalExceptionHandler {
                 .status(HttpStatus.BAD_REQUEST)
                 .body(new ApiErrorResponse(
                         HttpStatus.BAD_REQUEST.value(),
-                        "REGISTRATION_ERROR",
+                        REGISTRATION_ERROR,
                         ex.getMessage()
                 ));
     }
@@ -48,7 +53,7 @@ public class GlobalExceptionHandler {
                 .status(HttpStatus.INTERNAL_SERVER_ERROR)
                 .body(new ApiErrorResponse(
                         HttpStatus.INTERNAL_SERVER_ERROR.value(),
-                        "INTERNAL_ERROR",
+                        INTERNAL_ERROR,
                         ex.getMessage()
                 ));
     }
diff --git a/src/main/java/com/company/usermanagement/exception/RegistrationException.java b/src/main/java/com/company/usermanagement/exception/RegistrationException.java
index b7908a8..f667381 100644
--- a/src/main/java/com/company/usermanagement/exception/RegistrationException.java
+++ b/src/main/java/com/company/usermanagement/exception/RegistrationException.java
@@ -1,6 +1,8 @@
 package com.company.usermanagement.exception;
 
 public class RegistrationException extends RuntimeException {
+    private static final long serialVersionUID = 1L;
+
     public RegistrationException(String message) {
         super(message);
     }
diff --git a/src/main/java/com/company/usermanagement/exception/UserAlreadyExistsException.java b/src/main/java/com/company/usermanagement/exception/UserAlreadyExistsException.java
index 250613d..d9e2b3f 100644
--- a/src/main/java/com/company/usermanagement/exception/UserAlreadyExistsException.java
+++ b/src/main/java/com/company/usermanagement/exception/UserAlreadyExistsException.java
@@ -1,8 +1,9 @@
 package com.company.usermanagement.exception;
 
 public class UserAlreadyExistsException extends RuntimeException {
+    private static final long serialVersionUID = 1L;
+
     public UserAlreadyExistsException(String message) {
         super(message);
     }
 }
-
diff --git a/src/main/java/com/company/usermanagement/repository/UserRepository.java b/src/main/java/com/company/usermanagement/repository/UserRepository.java
index 21ddcfc..04c6055 100644
--- a/src/main/java/com/company/usermanagement/repository/UserRepository.java
+++ b/src/main/java/com/company/usermanagement/repository/UserRepository.java
@@ -2,20 +2,18 @@ package com.company.usermanagement.repository;
 
 import com.company.usermanagement.entity.Role;
 import com.company.usermanagement.entity.User;
-import org.springframework.data.jpa.repository.JpaRepository;
-
-import org.springframework.stereotype.Repository;
-
-import java.util.List;
-import java.util.Optional;
+import org.springframework.data.jpa.repository.JpaRepository;
+import org.springframework.stereotype.Repository;
+
+import java.util.List;
+import java.util.Optional;
 
 @Repository
-public interface UserRepository extends JpaRepository<User, Long> {
-
-    public Optional<User> findByUsername(String username);
-
-    public Optional<User> findByEmail(String email);
-
-    List<User> findByRolesContaining(Role role);
-
-}
+public interface UserRepository extends JpaRepository<User, Long> {
+
+    Optional<User> findByUsername(String username);
+
+    Optional<User> findByEmail(String email);
+
+    List<User> findByRolesContaining(Role role);
+}
diff --git a/src/main/java/com/company/usermanagement/security/controller/JwtTestController.java b/src/main/java/com/company/usermanagement/security/controller/JwtTestController.java
index 03a1ecb..81cf8a4 100644
--- a/src/main/java/com/company/usermanagement/security/controller/JwtTestController.java
+++ b/src/main/java/com/company/usermanagement/security/controller/JwtTestController.java
@@ -1,6 +1,5 @@
 package com.company.usermanagement.security.controller;
 
-
 import com.company.usermanagement.security.dto.JwtCustomRequest;
 import com.company.usermanagement.security.service.JwtSecretGeneratorService;
 import com.company.usermanagement.security.utility.JwtUtils;
@@ -47,4 +46,3 @@ public class JwtTestController {
         );
     }
 }
-
diff --git a/src/main/java/com/company/usermanagement/security/dto/JwtCustomRequest.java b/src/main/java/com/company/usermanagement/security/dto/JwtCustomRequest.java
index 32a2d1e..454f7f4 100644
--- a/src/main/java/com/company/usermanagement/security/dto/JwtCustomRequest.java
+++ b/src/main/java/com/company/usermanagement/security/dto/JwtCustomRequest.java
@@ -16,5 +16,4 @@ public class JwtCustomRequest {
     private Map<String, Object> claims;
 
     private Long expirationMs;
-
 }
diff --git a/src/main/java/com/company/usermanagement/security/filter/JwtAuthenticationFilter.java b/src/main/java/com/company/usermanagement/security/filter/JwtAuthenticationFilter.java
index 1b373da..9a25c85 100644
--- a/src/main/java/com/company/usermanagement/security/filter/JwtAuthenticationFilter.java
+++ b/src/main/java/com/company/usermanagement/security/filter/JwtAuthenticationFilter.java
@@ -13,12 +13,16 @@ import org.springframework.security.core.userdetails.UserDetails;
 import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
 import org.springframework.stereotype.Component;
 import org.springframework.web.filter.OncePerRequestFilter;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import java.io.IOException;
 
 @Component
 public class JwtAuthenticationFilter extends OncePerRequestFilter {
 
+    private static final Logger LOGGER = LoggerFactory.getLogger(JwtAuthenticationFilter.class);
+
     private final JwtService jwtService;
     private final UserService userService;
 
@@ -48,7 +52,7 @@ public class JwtAuthenticationFilter extends OncePerRequestFilter {
 
         // 4. Estrai lo username dal token
         final String username = jwtService.extractUsername(jwt);
-        System.out.println(username);
+        LOGGER.debug("JWT subject extracted: {}", username);
 
         // 5. Controlla se lo username esiste e se l'utente non è già autenticato
         if (username != null && SecurityContextHolder.getContext().getAuthentication() == null) {
diff --git a/src/main/java/com/company/usermanagement/security/handler/AccessDeniedHandlerJwt.java b/src/main/java/com/company/usermanagement/security/handler/AccessDeniedHandlerJwt.java
index 6c38691..a2b1eeb 100644
--- a/src/main/java/com/company/usermanagement/security/handler/AccessDeniedHandlerJwt.java
+++ b/src/main/java/com/company/usermanagement/security/handler/AccessDeniedHandlerJwt.java
@@ -11,13 +11,14 @@ import java.io.IOException;
 
 @Component
 public class AccessDeniedHandlerJwt implements AccessDeniedHandler {
+    private static final String FORBIDDEN_JSON = "{\"error\":\"FORBIDDEN\"}";
+
     @Override
     public void handle(HttpServletRequest request,
                        HttpServletResponse response,
                        AccessDeniedException ex) throws IOException, ServletException {
         response.setStatus(HttpServletResponse.SC_FORBIDDEN);
         response.setContentType("application/json");
-        response.getWriter().write("{\"error\":\"FORBIDDEN\"}");
+        response.getWriter().write(FORBIDDEN_JSON);
     }
 }
-
diff --git a/src/main/java/com/company/usermanagement/security/handler/AuthEntryPointJwt.java b/src/main/java/com/company/usermanagement/security/handler/AuthEntryPointJwt.java
index 49a3dfa..abbfa06 100644
--- a/src/main/java/com/company/usermanagement/security/handler/AuthEntryPointJwt.java
+++ b/src/main/java/com/company/usermanagement/security/handler/AuthEntryPointJwt.java
@@ -13,6 +13,8 @@ import java.util.Map;
 @Component
 public class AuthEntryPointJwt implements AuthenticationEntryPoint {
 
+    private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();
+
     @Override
     public void commence(HttpServletRequest request,
                          HttpServletResponse response,
@@ -27,6 +29,6 @@ public class AuthEntryPointJwt implements AuthenticationEntryPoint {
                 "message", "Token JWT mancante o non valido"
         );
 
-        new ObjectMapper().writeValue(response.getOutputStream(), body);
+        OBJECT_MAPPER.writeValue(response.getOutputStream(), body);
     }
 }
diff --git a/src/main/java/com/company/usermanagement/security/service/JwtSecretGeneratorService.java b/src/main/java/com/company/usermanagement/security/service/JwtSecretGeneratorService.java
index cc66af9..7d619ee 100644
--- a/src/main/java/com/company/usermanagement/security/service/JwtSecretGeneratorService.java
+++ b/src/main/java/com/company/usermanagement/security/service/JwtSecretGeneratorService.java
@@ -8,9 +8,11 @@ import org.springframework.stereotype.Service;
 @Service
 public class JwtSecretGeneratorService {
 
+    private static final SignatureAlgorithm SIGNATURE_ALGORITHM = SignatureAlgorithm.HS512;
+
     public String generateHs512Secret() {
         return Encoders.BASE64.encode(
-                Keys.secretKeyFor(SignatureAlgorithm.HS512).getEncoded()
+                Keys.secretKeyFor(SIGNATURE_ALGORITHM).getEncoded()
         );
     }
 }
diff --git a/src/main/java/com/company/usermanagement/security/service/JwtService.java b/src/main/java/com/company/usermanagement/security/service/JwtService.java
index 4c59e17..423d18a 100644
--- a/src/main/java/com/company/usermanagement/security/service/JwtService.java
+++ b/src/main/java/com/company/usermanagement/security/service/JwtService.java
@@ -1,11 +1,8 @@
 package com.company.usermanagement.security.service;
 
-import com.company.usermanagement.configuration.security.JwtProperties;
 import io.jsonwebtoken.Claims;
 import io.jsonwebtoken.Jwts;
 import io.jsonwebtoken.SignatureAlgorithm;
-import io.jsonwebtoken.io.Decoders;
-import io.jsonwebtoken.security.Keys;
 import jakarta.annotation.PostConstruct;
 import org.springframework.security.core.Authentication;
 import org.springframework.security.core.userdetails.UserDetails;
@@ -19,12 +16,8 @@ import java.util.function.Function;
 public class JwtService {
     private final SecretKey secretKey;
 
-    public JwtService(JwtProperties jwtProperties, SecretKey secretKey) {
-        //        byte[] keyBytes = Decoders.BASE64.decode(jwtProperties.secret());
-        this.secretKey = Keys.hmacShaKeyFor(
-                Decoders.BASE64.decode(jwtProperties.secret())
-        );
-
+    public JwtService(SecretKey secretKey) {
+        this.secretKey = secretKey;
     }
 
     @PostConstruct
diff --git a/src/main/java/com/company/usermanagement/security/utility/JwtUtils.java b/src/main/java/com/company/usermanagement/security/utility/JwtUtils.java
index 1070d56..28d8e71 100644
--- a/src/main/java/com/company/usermanagement/security/utility/JwtUtils.java
+++ b/src/main/java/com/company/usermanagement/security/utility/JwtUtils.java
@@ -4,7 +4,6 @@ import io.jsonwebtoken.Jwts;
 import io.jsonwebtoken.SignatureAlgorithm;
 import io.jsonwebtoken.io.Decoders;
 import io.jsonwebtoken.security.Keys;
-import jakarta.annotation.PostConstruct;
 import org.springframework.beans.factory.annotation.Value;
 import org.springframework.security.core.userdetails.UserDetails;
 import org.springframework.stereotype.Component;
@@ -53,5 +52,4 @@ public class JwtUtils {
                 null
         );
     }
-
 }
diff --git a/src/main/java/com/company/usermanagement/service/UserService.java b/src/main/java/com/company/usermanagement/service/UserService.java
index 155a439..31d7305 100644
--- a/src/main/java/com/company/usermanagement/service/UserService.java
+++ b/src/main/java/com/company/usermanagement/service/UserService.java
@@ -25,48 +25,46 @@ public class UserService implements UserDetailsService {
         this.userRepository = userRepository;
     }
 
-    public User registerUser(RegisterRequestDTO requestDTO) {
-        String username = requestDTO.username();
-        String rawPassword = requestDTO.password();
-        String email = requestDTO.email();
-        String name = requestDTO.name();
-        long userCount = userRepository.count();
-        if (userRepository.findByUsername(username).isPresent()) {
-            throw new UserAlreadyExistsException("Username già esistente");
-        }
-
-        if (userRepository.findByEmail(email).isPresent()) {
-            throw new UserAlreadyExistsException("Email già esistente");
-        }
-
-
-        User newUser = new User();
-        newUser.setUsername(username);
-        newUser.setPassword(passwordEncoder.encode(rawPassword));
-        newUser.setEmail(email);
-        newUser.setName(name);
-        newUser.setEnabled(true);
-        Set<Role> roles = new HashSet<>();
-
-        if (userCount==0) {
-            roles.add(Role.ADMIN);
-        } else {
-            roles.add(Role.USER);
-        }
-        newUser.setRoles(roles);
-
-        User savedUser = userRepository.save(newUser);
-
-        if (savedUser.getId()==null) {
-            throw new RegistrationException("Errore durante la registrazione");
-        }
-        return savedUser;
-    }
-
-    //For login user
-    @Override
-    public User loadUserByUsername(String username) throws UsernameNotFoundException {
-        return userRepository.findByUsername(username)
-                .orElseThrow(() -> new UsernameNotFoundException("User not found with username: " + username));
+    public User registerUser(RegisterRequestDTO requestDTO) {
+        String username = requestDTO.username();
+        String rawPassword = requestDTO.password();
+        String email = requestDTO.email();
+        String name = requestDTO.name();
+        long userCount = userRepository.count();
+        if (userRepository.findByUsername(username).isPresent()) {
+            throw new UserAlreadyExistsException("Username già esistente");
+        }
+
+        if (userRepository.findByEmail(email).isPresent()) {
+            throw new UserAlreadyExistsException("Email già esistente");
+        }
+
+        User newUser = new User();
+        newUser.setUsername(username);
+        newUser.setPassword(passwordEncoder.encode(rawPassword));
+        newUser.setEmail(email);
+        newUser.setName(name);
+        newUser.setEnabled(true);
+        Set<Role> roles = new HashSet<>();
+
+        if (userCount == 0) {
+            roles.add(Role.ADMIN);
+        } else {
+            roles.add(Role.USER);
+        }
+        newUser.setRoles(roles);
+
+        User savedUser = userRepository.save(newUser);
+
+        if (savedUser.getId() == null) {
+            throw new RegistrationException("Errore durante la registrazione");
+        }
+        return savedUser;
+    }
+
+    @Override
+    public User loadUserByUsername(String username) throws UsernameNotFoundException {
+        return userRepository.findByUsername(username)
+                .orElseThrow(() -> new UsernameNotFoundException("User not found with username: " + username));
     }
 }
